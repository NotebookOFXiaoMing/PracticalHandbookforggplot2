<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 R语言ggplot2饼状图 | R语言ggplot2科研数据可视化实用手册</title>
  <meta name="description" content="Chapter 7 R语言ggplot2饼状图 | R语言ggplot2科研数据可视化实用手册" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 R语言ggplot2饼状图 | R语言ggplot2科研数据可视化实用手册" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 R语言ggplot2饼状图 | R语言ggplot2科研数据可视化实用手册" />
  
  
  

<meta name="author" content="闫明" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="r语言ggplot2折线图.html"/>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">xiaoming</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> R语言、Rstudio、R包ggplot2安装 (win10)</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#r语言官网"><i class="fa fa-check"></i><b>1.1</b> R语言官网</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#rstudio官网"><i class="fa fa-check"></i><b>1.2</b> Rstudio官网</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="绘图数据准备.html"><a href="绘图数据准备.html"><i class="fa fa-check"></i><b>2</b> 绘图数据准备</a>
<ul>
<li class="chapter" data-level="2.1" data-path="绘图数据准备.html"><a href="绘图数据准备.html#文件的路径"><i class="fa fa-check"></i><b>2.1</b> 文件的路径</a></li>
<li class="chapter" data-level="2.2" data-path="绘图数据准备.html"><a href="绘图数据准备.html#读取数据"><i class="fa fa-check"></i><b>2.2</b> 读取数据</a></li>
<li class="chapter" data-level="2.3" data-path="绘图数据准备.html"><a href="绘图数据准备.html#读取数据集以后对数据集进行操作"><i class="fa fa-check"></i><b>2.3</b> 读取数据集以后对数据集进行操作</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r语言ggplot2散点图.html"><a href="r语言ggplot2散点图.html"><i class="fa fa-check"></i><b>3</b> R语言ggplot2散点图</a></li>
<li class="chapter" data-level="4" data-path="r语言ggplot2柱形图.html"><a href="r语言ggplot2柱形图.html"><i class="fa fa-check"></i><b>4</b> R语言ggplot2柱形图</a>
<ul>
<li class="chapter" data-level="4.1" data-path="r语言ggplot2柱形图.html"><a href="r语言ggplot2柱形图.html#最基本的柱形图需要准备的数据"><i class="fa fa-check"></i><b>4.1</b> 最基本的柱形图需要准备的数据</a></li>
<li class="chapter" data-level="4.2" data-path="r语言ggplot2柱形图.html"><a href="r语言ggplot2柱形图.html#簇状柱形图"><i class="fa fa-check"></i><b>4.2</b> 簇状柱形图</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="r语言ggplot2柱形图.html"><a href="r语言ggplot2柱形图.html#接下来看每周一图里面的例子"><i class="fa fa-check"></i><b>4.2.1</b> 接下来看每周一图里面的例子</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="r语言ggplot2柱形图.html"><a href="r语言ggplot2柱形图.html#堆积柱形图"><i class="fa fa-check"></i><b>4.3</b> 堆积柱形图</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="r语言ggplot2柱形图.html"><a href="r语言ggplot2柱形图.html#实际例子"><i class="fa fa-check"></i><b>4.3.1</b> 实际例子</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="r语言ggplot2箱线图.html"><a href="r语言ggplot2箱线图.html"><i class="fa fa-check"></i><b>5</b> R语言ggplot2箱线图</a>
<ul>
<li class="chapter" data-level="5.1" data-path="r语言ggplot2箱线图.html"><a href="r语言ggplot2箱线图.html#首先是箱线图"><i class="fa fa-check"></i><b>5.1</b> 首先是箱线图</a></li>
<li class="chapter" data-level="5.2" data-path="r语言ggplot2箱线图.html"><a href="r语言ggplot2箱线图.html#接下来是带有分组的箱线图"><i class="fa fa-check"></i><b>5.2</b> 接下来是带有分组的箱线图</a></li>
<li class="chapter" data-level="5.3" data-path="r语言ggplot2箱线图.html"><a href="r语言ggplot2箱线图.html#接下来是小提琴图"><i class="fa fa-check"></i><b>5.3</b> 接下来是小提琴图</a></li>
<li class="chapter" data-level="5.4" data-path="r语言ggplot2箱线图.html"><a href="r语言ggplot2箱线图.html#类似于箱线图小提琴图的还有"><i class="fa fa-check"></i><b>5.4</b> 类似于箱线图/小提琴图的还有</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="r语言ggplot2折线图.html"><a href="r语言ggplot2折线图.html"><i class="fa fa-check"></i><b>6</b> R语言ggplot2折线图</a>
<ul>
<li class="chapter" data-level="6.1" data-path="r语言ggplot2折线图.html"><a href="r语言ggplot2折线图.html#最基本的折线图"><i class="fa fa-check"></i><b>6.1</b> 最基本的折线图</a></li>
<li class="chapter" data-level="6.2" data-path="r语言ggplot2折线图.html"><a href="r语言ggplot2折线图.html#分组的折线图"><i class="fa fa-check"></i><b>6.2</b> 分组的折线图</a></li>
<li class="chapter" data-level="6.3" data-path="r语言ggplot2折线图.html"><a href="r语言ggplot2折线图.html#添加线段"><i class="fa fa-check"></i><b>6.3</b> 添加线段</a></li>
<li class="chapter" data-level="6.4" data-path="r语言ggplot2折线图.html"><a href="r语言ggplot2折线图.html#添加辅助线"><i class="fa fa-check"></i><b>6.4</b> 添加辅助线</a></li>
<li class="chapter" data-level="6.5" data-path="r语言ggplot2折线图.html"><a href="r语言ggplot2折线图.html#面积图"><i class="fa fa-check"></i><b>6.5</b> 面积图</a></li>
<li class="chapter" data-level="6.6" data-path="r语言ggplot2折线图.html"><a href="r语言ggplot2折线图.html#实际例子-1"><i class="fa fa-check"></i><b>6.6</b> 实际例子</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="r语言ggplot2饼状图.html"><a href="r语言ggplot2饼状图.html"><i class="fa fa-check"></i><b>7</b> R语言ggplot2饼状图</a>
<ul>
<li class="chapter" data-level="7.1" data-path="r语言ggplot2饼状图.html"><a href="r语言ggplot2饼状图.html#最基本的饼状图"><i class="fa fa-check"></i><b>7.1</b> 最基本的饼状图</a></li>
<li class="chapter" data-level="7.2" data-path="r语言ggplot2饼状图.html"><a href="r语言ggplot2饼状图.html#中间空心的饼状图"><i class="fa fa-check"></i><b>7.2</b> 中间空心的饼状图</a></li>
<li class="chapter" data-level="7.3" data-path="r语言ggplot2饼状图.html"><a href="r语言ggplot2饼状图.html#其他效果的饼状图"><i class="fa fa-check"></i><b>7.3</b> 其他效果的饼状图</a></li>
<li class="chapter" data-level="7.4" data-path="r语言ggplot2饼状图.html"><a href="r语言ggplot2饼状图.html#其中某一块可以离开的饼图"><i class="fa fa-check"></i><b>7.4</b> 其中某一块可以离开的饼图</a></li>
<li class="chapter" data-level="7.5" data-path="r语言ggplot2饼状图.html"><a href="r语言ggplot2饼状图.html#多层嵌套的饼状图"><i class="fa fa-check"></i><b>7.5</b> 多层嵌套的饼状图</a></li>
<li class="chapter" data-level="7.6" data-path="r语言ggplot2饼状图.html"><a href="r语言ggplot2饼状图.html#一次性画很多个饼状图"><i class="fa fa-check"></i><b>7.6</b> 一次性画很多个饼状图</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R语言ggplot2科研数据可视化实用手册</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r语言ggplot2饼状图" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> R语言ggplot2饼状图</h1>
<p>饼状图主要用来展示比例，R语言ggplot2包好像没有专门画饼状图的函数，ggplot2的实现方式是先画堆积柱形图，然后再极坐标的形式转换成饼图，这里极坐标具体的含义我也不懂，这里先记住这个名词</p>
<div id="最基本的饼状图" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> 最基本的饼状图</h2>
<p>最基本的数据格式如下</p>
<p><img src="img/07-pieplot/001.png"></p>
<p>第一列是变量的名字，第二列是变量的数值，这里数值可以先不用转换成比例</p>
<p>作图代码</p>
<p>参考链接 <a href="http://www.sthda.com/english/wiki/ggplot2-pie-chart-quick-start-guide-r-software-and-data-visualization" class="uri">http://www.sthda.com/english/wiki/ggplot2-pie-chart-quick-start-guide-r-software-and-data-visualization</a></p>
<p>堆积柱形图代码</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="r语言ggplot2饼状图.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb180-2"><a href="r语言ggplot2饼状图.html#cb180-2" aria-hidden="true" tabindex="-1"></a>dat01<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;example_data/07-pieplot/dat01.xlsx&quot;</span>)</span>
<span id="cb180-3"><a href="r语言ggplot2饼状图.html#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb180-4"><a href="r语言ggplot2饼状图.html#cb180-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>dat01,<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span>var2,<span class="at">fill=</span>var1))<span class="sc">+</span></span>
<span id="cb180-5"><a href="r语言ggplot2饼状图.html#cb180-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>,<span class="at">width=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-131-1.png" width="672" /></p>
<p>加上极坐标转换成饼状图</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="r语言ggplot2饼状图.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb181-2"><a href="r语言ggplot2饼状图.html#cb181-2" aria-hidden="true" tabindex="-1"></a>dat01<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;example_data/07-pieplot/dat01.xlsx&quot;</span>)</span>
<span id="cb181-3"><a href="r语言ggplot2饼状图.html#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb181-4"><a href="r语言ggplot2饼状图.html#cb181-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>dat01,<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span>var2,<span class="at">fill=</span>var1))<span class="sc">+</span></span>
<span id="cb181-5"><a href="r语言ggplot2饼状图.html#cb181-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>,<span class="at">width=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb181-6"><a href="r语言ggplot2饼状图.html#cb181-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-132-1.png" width="672" /></p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="r语言ggplot2饼状图.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>dat01,<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span>var2,<span class="at">fill=</span>var1))<span class="sc">+</span></span>
<span id="cb182-2"><a href="r语言ggplot2饼状图.html#cb182-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>,<span class="at">width=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb182-3"><a href="r语言ggplot2饼状图.html#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">20</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-132-2.png" width="672" /></p>
<p>start参数可以让饼状图顺时针或者逆时针旋转</p>
<p>饼状图最常用的一个操作是在给个部分添加上文字展示真实的比例值，这里我们使用annotate()函数,这个比例值需要自己先算一下</p>
<p>这里需要注意的一个地方是坐标，原来的坐标跟极坐标之间是如何转化的我还没有搞明白，我的做法是先随便指定一个位置，然后根据这个文本在图中出现的位置然后调试</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="r语言ggplot2饼状图.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb183-2"><a href="r语言ggplot2饼状图.html#cb183-2" aria-hidden="true" tabindex="-1"></a>dat01<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;example_data/07-pieplot/dat01.xlsx&quot;</span>)</span>
<span id="cb183-3"><a href="r语言ggplot2饼状图.html#cb183-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb183-4"><a href="r语言ggplot2饼状图.html#cb183-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>dat01,<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span>var2,<span class="at">fill=</span>var1))<span class="sc">+</span></span>
<span id="cb183-5"><a href="r语言ggplot2饼状图.html#cb183-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>,<span class="at">width=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb183-6"><a href="r语言ggplot2饼状图.html#cb183-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb183-7"><a href="r语言ggplot2饼状图.html#cb183-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">90</span>,<span class="at">label=</span><span class="st">&quot;20%&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-133-1.png" width="672" /></p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="r语言ggplot2饼状图.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>dat01,<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span>var2,<span class="at">fill=</span>var1))<span class="sc">+</span></span>
<span id="cb184-2"><a href="r语言ggplot2饼状图.html#cb184-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>,<span class="at">width=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb184-3"><a href="r语言ggplot2饼状图.html#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb184-4"><a href="r语言ggplot2饼状图.html#cb184-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">90</span>,<span class="at">label=</span><span class="st">&quot;20%&quot;</span>)<span class="sc">+</span></span>
<span id="cb184-5"><a href="r语言ggplot2饼状图.html#cb184-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">60</span>,<span class="at">label=</span><span class="st">&quot;30%&quot;</span>)<span class="sc">+</span></span>
<span id="cb184-6"><a href="r语言ggplot2饼状图.html#cb184-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">20</span>,<span class="at">label=</span><span class="st">&quot;50%&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-133-2.png" width="672" /></p>
<p>然后是自定义颜色</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="r语言ggplot2饼状图.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb185-2"><a href="r语言ggplot2饼状图.html#cb185-2" aria-hidden="true" tabindex="-1"></a>dat01<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;example_data/07-pieplot/dat01.xlsx&quot;</span>)</span>
<span id="cb185-3"><a href="r语言ggplot2饼状图.html#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb185-4"><a href="r语言ggplot2饼状图.html#cb185-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-5"><a href="r语言ggplot2饼状图.html#cb185-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>dat01,<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span>var2,<span class="at">fill=</span>var1))<span class="sc">+</span></span>
<span id="cb185-6"><a href="r语言ggplot2饼状图.html#cb185-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>,<span class="at">width=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb185-7"><a href="r语言ggplot2饼状图.html#cb185-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb185-8"><a href="r语言ggplot2饼状图.html#cb185-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">90</span>,<span class="at">label=</span><span class="st">&quot;20%&quot;</span>)<span class="sc">+</span></span>
<span id="cb185-9"><a href="r语言ggplot2饼状图.html#cb185-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">60</span>,<span class="at">label=</span><span class="st">&quot;30%&quot;</span>)<span class="sc">+</span></span>
<span id="cb185-10"><a href="r语言ggplot2饼状图.html#cb185-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">20</span>,<span class="at">label=</span><span class="st">&quot;50%&quot;</span>)<span class="sc">+</span></span>
<span id="cb185-11"><a href="r语言ggplot2饼状图.html#cb185-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span><span class="ot">=</span><span class="st">&quot;#7f7f7f&quot;</span>,</span>
<span id="cb185-12"><a href="r语言ggplot2饼状图.html#cb185-12" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;B&quot;</span><span class="ot">=</span><span class="st">&quot;#fe0904&quot;</span>,</span>
<span id="cb185-13"><a href="r语言ggplot2饼状图.html#cb185-13" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;D&quot;</span><span class="ot">=</span><span class="st">&quot;#f9b54f&quot;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-134-1.png" width="672" /></p>
<p>饼状图的文本一种比较方便的处理方式是直接添加到图例的文本位置上</p>
<p>修改图例的文本，可以在自定义颜色的参数里添加上labels参数</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="r语言ggplot2饼状图.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb186-2"><a href="r语言ggplot2饼状图.html#cb186-2" aria-hidden="true" tabindex="-1"></a>dat01<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;example_data/07-pieplot/dat01.xlsx&quot;</span>)</span>
<span id="cb186-3"><a href="r语言ggplot2饼状图.html#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb186-4"><a href="r语言ggplot2饼状图.html#cb186-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-5"><a href="r语言ggplot2饼状图.html#cb186-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>dat01,<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span>var2,<span class="at">fill=</span>var1))<span class="sc">+</span></span>
<span id="cb186-6"><a href="r语言ggplot2饼状图.html#cb186-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>,<span class="at">width=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb186-7"><a href="r语言ggplot2饼状图.html#cb186-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb186-8"><a href="r语言ggplot2饼状图.html#cb186-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">90</span>,<span class="at">label=</span><span class="st">&quot;20%&quot;</span>)<span class="sc">+</span></span>
<span id="cb186-9"><a href="r语言ggplot2饼状图.html#cb186-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">60</span>,<span class="at">label=</span><span class="st">&quot;30%&quot;</span>)<span class="sc">+</span></span>
<span id="cb186-10"><a href="r语言ggplot2饼状图.html#cb186-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">20</span>,<span class="at">label=</span><span class="st">&quot;50%&quot;</span>)<span class="sc">+</span></span>
<span id="cb186-11"><a href="r语言ggplot2饼状图.html#cb186-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span><span class="ot">=</span><span class="st">&quot;#7f7f7f&quot;</span>,</span>
<span id="cb186-12"><a href="r语言ggplot2饼状图.html#cb186-12" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;B&quot;</span><span class="ot">=</span><span class="st">&quot;#fe0904&quot;</span>,</span>
<span id="cb186-13"><a href="r语言ggplot2饼状图.html#cb186-13" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;D&quot;</span><span class="ot">=</span><span class="st">&quot;#f9b54f&quot;</span>),</span>
<span id="cb186-14"><a href="r语言ggplot2饼状图.html#cb186-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span><span class="ot">=</span> <span class="st">&quot;A (20%)&quot;</span>,</span>
<span id="cb186-15"><a href="r语言ggplot2饼状图.html#cb186-15" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;B&quot;</span> <span class="ot">=</span> <span class="st">&quot;B (30%)&quot;</span>,</span>
<span id="cb186-16"><a href="r语言ggplot2饼状图.html#cb186-16" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;D&quot;</span> <span class="ot">=</span> <span class="st">&quot;D (50%)&quot;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>
<p>饼状图通常是没有背后的灰色背景之类的，通过设置主题把这些全部去掉</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="r语言ggplot2饼状图.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb187-2"><a href="r语言ggplot2饼状图.html#cb187-2" aria-hidden="true" tabindex="-1"></a>dat01<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;example_data/07-pieplot/dat01.xlsx&quot;</span>)</span>
<span id="cb187-3"><a href="r语言ggplot2饼状图.html#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb187-4"><a href="r语言ggplot2饼状图.html#cb187-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-5"><a href="r语言ggplot2饼状图.html#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>dat01,<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span>var2,<span class="at">fill=</span>var1))<span class="sc">+</span></span>
<span id="cb187-6"><a href="r语言ggplot2饼状图.html#cb187-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>,<span class="at">width=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb187-7"><a href="r语言ggplot2饼状图.html#cb187-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb187-8"><a href="r语言ggplot2饼状图.html#cb187-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">90</span>,<span class="at">label=</span><span class="st">&quot;20%&quot;</span>)<span class="sc">+</span></span>
<span id="cb187-9"><a href="r语言ggplot2饼状图.html#cb187-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">60</span>,<span class="at">label=</span><span class="st">&quot;30%&quot;</span>)<span class="sc">+</span></span>
<span id="cb187-10"><a href="r语言ggplot2饼状图.html#cb187-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">20</span>,<span class="at">label=</span><span class="st">&quot;50%&quot;</span>)<span class="sc">+</span></span>
<span id="cb187-11"><a href="r语言ggplot2饼状图.html#cb187-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span><span class="ot">=</span><span class="st">&quot;#7f7f7f&quot;</span>,</span>
<span id="cb187-12"><a href="r语言ggplot2饼状图.html#cb187-12" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;B&quot;</span><span class="ot">=</span><span class="st">&quot;#fe0904&quot;</span>,</span>
<span id="cb187-13"><a href="r语言ggplot2饼状图.html#cb187-13" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;D&quot;</span><span class="ot">=</span><span class="st">&quot;#f9b54f&quot;</span>))<span class="sc">+</span></span>
<span id="cb187-14"><a href="r语言ggplot2饼状图.html#cb187-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-136-1.png" width="672" /></p>
<p>以上是最基本的饼状图</p>
</div>
<div id="中间空心的饼状图" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> 中间空心的饼状图</h2>
<p>通过设置x坐标的范围来实现其中的空心效果</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="r语言ggplot2饼状图.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb188-2"><a href="r语言ggplot2饼状图.html#cb188-2" aria-hidden="true" tabindex="-1"></a>dat01<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;example_data/07-pieplot/dat01.xlsx&quot;</span>)</span>
<span id="cb188-3"><a href="r语言ggplot2饼状图.html#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb188-4"><a href="r语言ggplot2饼状图.html#cb188-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-5"><a href="r语言ggplot2饼状图.html#cb188-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>dat01,<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span>var2,<span class="at">fill=</span>var1))<span class="sc">+</span></span>
<span id="cb188-6"><a href="r语言ggplot2饼状图.html#cb188-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>,<span class="at">width=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb188-7"><a href="r语言ggplot2饼状图.html#cb188-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb188-8"><a href="r语言ggplot2饼状图.html#cb188-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">90</span>,<span class="at">label=</span><span class="st">&quot;20%&quot;</span>)<span class="sc">+</span></span>
<span id="cb188-9"><a href="r语言ggplot2饼状图.html#cb188-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">60</span>,<span class="at">label=</span><span class="st">&quot;30%&quot;</span>)<span class="sc">+</span></span>
<span id="cb188-10"><a href="r语言ggplot2饼状图.html#cb188-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">20</span>,<span class="at">label=</span><span class="st">&quot;50%&quot;</span>)<span class="sc">+</span></span>
<span id="cb188-11"><a href="r语言ggplot2饼状图.html#cb188-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span><span class="ot">=</span><span class="st">&quot;#7f7f7f&quot;</span>,</span>
<span id="cb188-12"><a href="r语言ggplot2饼状图.html#cb188-12" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;B&quot;</span><span class="ot">=</span><span class="st">&quot;#fe0904&quot;</span>,</span>
<span id="cb188-13"><a href="r语言ggplot2饼状图.html#cb188-13" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;D&quot;</span><span class="ot">=</span><span class="st">&quot;#f9b54f&quot;</span>))<span class="sc">+</span></span>
<span id="cb188-14"><a href="r语言ggplot2饼状图.html#cb188-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb188-15"><a href="r语言ggplot2饼状图.html#cb188-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="cn">NA</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-137-1.png" width="672" /></p>
</div>
<div id="其他效果的饼状图" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> 其他效果的饼状图</h2>
<p>上面极坐标的参数是y,如果把参数改成x</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="r语言ggplot2饼状图.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb189-2"><a href="r语言ggplot2饼状图.html#cb189-2" aria-hidden="true" tabindex="-1"></a>dat01<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;example_data/07-pieplot/dat01.xlsx&quot;</span>)</span>
<span id="cb189-3"><a href="r语言ggplot2饼状图.html#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb189-4"><a href="r语言ggplot2饼状图.html#cb189-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-5"><a href="r语言ggplot2饼状图.html#cb189-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>dat01,<span class="fu">aes</span>(<span class="at">x=</span>var1,<span class="at">y=</span>var2,<span class="at">fill=</span>var1))<span class="sc">+</span></span>
<span id="cb189-6"><a href="r语言ggplot2饼状图.html#cb189-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">width=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb189-7"><a href="r语言ggplot2饼状图.html#cb189-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;x&quot;</span>, <span class="at">start=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb189-8"><a href="r语言ggplot2饼状图.html#cb189-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">90</span>,<span class="at">label=</span><span class="st">&quot;20%&quot;</span>)<span class="sc">+</span></span>
<span id="cb189-9"><a href="r语言ggplot2饼状图.html#cb189-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">60</span>,<span class="at">label=</span><span class="st">&quot;30%&quot;</span>)<span class="sc">+</span></span>
<span id="cb189-10"><a href="r语言ggplot2饼状图.html#cb189-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">20</span>,<span class="at">label=</span><span class="st">&quot;50%&quot;</span>)<span class="sc">+</span></span>
<span id="cb189-11"><a href="r语言ggplot2饼状图.html#cb189-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span><span class="ot">=</span><span class="st">&quot;#7f7f7f&quot;</span>,</span>
<span id="cb189-12"><a href="r语言ggplot2饼状图.html#cb189-12" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;B&quot;</span><span class="ot">=</span><span class="st">&quot;#fe0904&quot;</span>,</span>
<span id="cb189-13"><a href="r语言ggplot2饼状图.html#cb189-13" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;D&quot;</span><span class="ot">=</span><span class="st">&quot;#f9b54f&quot;</span>))<span class="sc">+</span></span>
<span id="cb189-14"><a href="r语言ggplot2饼状图.html#cb189-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-138-1.png" width="672" /></p>
<p>普通的柱形图加上极坐标转化的效果</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="r语言ggplot2饼状图.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb190-2"><a href="r语言ggplot2饼状图.html#cb190-2" aria-hidden="true" tabindex="-1"></a>dat01<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;example_data/07-pieplot/dat01.xlsx&quot;</span>)</span>
<span id="cb190-3"><a href="r语言ggplot2饼状图.html#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb190-4"><a href="r语言ggplot2饼状图.html#cb190-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-5"><a href="r语言ggplot2饼状图.html#cb190-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>dat01,<span class="fu">aes</span>(<span class="at">x=</span>var1,<span class="at">y=</span>var2,<span class="at">fill=</span>var1))<span class="sc">+</span></span>
<span id="cb190-6"><a href="r语言ggplot2饼状图.html#cb190-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">width=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb190-7"><a href="r语言ggplot2饼状图.html#cb190-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb190-8"><a href="r语言ggplot2饼状图.html#cb190-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">90</span>,<span class="at">label=</span><span class="st">&quot;20%&quot;</span>)<span class="sc">+</span></span>
<span id="cb190-9"><a href="r语言ggplot2饼状图.html#cb190-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">60</span>,<span class="at">label=</span><span class="st">&quot;30%&quot;</span>)<span class="sc">+</span></span>
<span id="cb190-10"><a href="r语言ggplot2饼状图.html#cb190-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">20</span>,<span class="at">label=</span><span class="st">&quot;50%&quot;</span>)<span class="sc">+</span></span>
<span id="cb190-11"><a href="r语言ggplot2饼状图.html#cb190-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span><span class="ot">=</span><span class="st">&quot;#7f7f7f&quot;</span>,</span>
<span id="cb190-12"><a href="r语言ggplot2饼状图.html#cb190-12" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;B&quot;</span><span class="ot">=</span><span class="st">&quot;#fe0904&quot;</span>,</span>
<span id="cb190-13"><a href="r语言ggplot2饼状图.html#cb190-13" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;D&quot;</span><span class="ot">=</span><span class="st">&quot;#f9b54f&quot;</span>))<span class="sc">+</span></span>
<span id="cb190-14"><a href="r语言ggplot2饼状图.html#cb190-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-139-1.png" width="672" /></p>
<p>以上文本位置都对不上，需要我们单独调节</p>
</div>
<div id="其中某一块可以离开的饼图" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> 其中某一块可以离开的饼图</h2>
<p>这个用ggplot2如何实现我暂时想不到，这里需要借助另外的R包ggforce,大家如果想要这种效果的话可以参考一下这个视频</p>
<p><a href="https://www.bilibili.com/video/BV1Sa411w7cP?spm_id_from=333.999.0.0" class="uri">https://www.bilibili.com/video/BV1Sa411w7cP?spm_id_from=333.999.0.0</a></p>
<p>这里就不介绍代码了</p>
</div>
<div id="多层嵌套的饼状图" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> 多层嵌套的饼状图</h2>
<p>多层嵌套的饼状图和一组的思路是一样的，我们多准备几组数据既可以了</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="r语言ggplot2饼状图.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb191-2"><a href="r语言ggplot2饼状图.html#cb191-2" aria-hidden="true" tabindex="-1"></a>dat01<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;example_data/07-pieplot/dat01.xlsx&quot;</span>)</span>
<span id="cb191-3"><a href="r语言ggplot2饼状图.html#cb191-3" aria-hidden="true" tabindex="-1"></a>dat02<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;example_data/07-pieplot/dat02.xlsx&quot;</span>)</span>
<span id="cb191-4"><a href="r语言ggplot2饼状图.html#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb191-5"><a href="r语言ggplot2饼状图.html#cb191-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-6"><a href="r语言ggplot2饼状图.html#cb191-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb191-7"><a href="r语言ggplot2饼状图.html#cb191-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">data=</span>dat01,<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span>var2,<span class="at">fill=</span>var1),</span>
<span id="cb191-8"><a href="r语言ggplot2饼状图.html#cb191-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>,<span class="at">width=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb191-9"><a href="r语言ggplot2饼状图.html#cb191-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">data=</span>dat02,<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">2</span>,<span class="at">y=</span>var2,<span class="at">fill=</span>var1),</span>
<span id="cb191-10"><a href="r语言ggplot2饼状图.html#cb191-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>,<span class="at">width=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb191-11"><a href="r语言ggplot2饼状图.html#cb191-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
<p>第二组数据里如果没有其中某个变量就会空白出来一部分</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="r语言ggplot2饼状图.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb192-2"><a href="r语言ggplot2饼状图.html#cb192-2" aria-hidden="true" tabindex="-1"></a>dat01<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;example_data/07-pieplot/dat01.xlsx&quot;</span>)</span>
<span id="cb192-3"><a href="r语言ggplot2饼状图.html#cb192-3" aria-hidden="true" tabindex="-1"></a>dat03<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;example_data/07-pieplot/dat03.xlsx&quot;</span>)</span>
<span id="cb192-4"><a href="r语言ggplot2饼状图.html#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb192-5"><a href="r语言ggplot2饼状图.html#cb192-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-6"><a href="r语言ggplot2饼状图.html#cb192-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb192-7"><a href="r语言ggplot2饼状图.html#cb192-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">data=</span>dat01,<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span>var2,<span class="at">fill=</span>var1),</span>
<span id="cb192-8"><a href="r语言ggplot2饼状图.html#cb192-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>,<span class="at">width=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb192-9"><a href="r语言ggplot2饼状图.html#cb192-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">data=</span>dat03,<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">2</span>,<span class="at">y=</span>var2,<span class="at">fill=</span>var1),</span>
<span id="cb192-10"><a href="r语言ggplot2饼状图.html#cb192-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>,<span class="at">width=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb192-11"><a href="r语言ggplot2饼状图.html#cb192-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-141-1.png" width="672" /></p>
<p>叠加三组数据</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="r语言ggplot2饼状图.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb193-2"><a href="r语言ggplot2饼状图.html#cb193-2" aria-hidden="true" tabindex="-1"></a>dat01<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;example_data/07-pieplot/dat01.xlsx&quot;</span>)</span>
<span id="cb193-3"><a href="r语言ggplot2饼状图.html#cb193-3" aria-hidden="true" tabindex="-1"></a>dat03<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;example_data/07-pieplot/dat03.xlsx&quot;</span>)</span>
<span id="cb193-4"><a href="r语言ggplot2饼状图.html#cb193-4" aria-hidden="true" tabindex="-1"></a>dat04<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">&quot;example_data/07-pieplot/dat04.xlsx&quot;</span>)</span>
<span id="cb193-5"><a href="r语言ggplot2饼状图.html#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb193-6"><a href="r语言ggplot2饼状图.html#cb193-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-7"><a href="r语言ggplot2饼状图.html#cb193-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb193-8"><a href="r语言ggplot2饼状图.html#cb193-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">data=</span>dat01,<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span>var2,<span class="at">fill=</span>var1),</span>
<span id="cb193-9"><a href="r语言ggplot2饼状图.html#cb193-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>,<span class="at">width=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb193-10"><a href="r语言ggplot2饼状图.html#cb193-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">data=</span>dat03,<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">2</span>,<span class="at">y=</span>var2,<span class="at">fill=</span>var1),</span>
<span id="cb193-11"><a href="r语言ggplot2饼状图.html#cb193-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>,<span class="at">width=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb193-12"><a href="r语言ggplot2饼状图.html#cb193-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">data=</span>dat04,<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">3</span>,<span class="at">y=</span>var2,<span class="at">fill=</span>var1),</span>
<span id="cb193-13"><a href="r语言ggplot2饼状图.html#cb193-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>,<span class="at">width=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb193-14"><a href="r语言ggplot2饼状图.html#cb193-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
</div>
<div id="一次性画很多个饼状图" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> 一次性画很多个饼状图</h2>
<p>这个用ggplot2如何实现我暂时也想不到了，这里借助额外的R包scatterpie,这里用之前B站录制过的视频介绍 <a href="https://www.bilibili.com/video/BV1nb4y1f75k?spm_id_from=333.999.0.0" class="uri">https://www.bilibili.com/video/BV1nb4y1f75k?spm_id_from=333.999.0.0</a></p>
<p>示例数据集如下</p>
<p><img src="img/07-pieplot/003.png"></p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="r语言ggplot2饼状图.html#cb194-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;example_data/07-pieplot/mutilpie_example.csv&quot;</span>,<span class="at">header=</span>T)</span>
<span id="cb194-2"><a href="r语言ggplot2饼状图.html#cb194-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##     x y  A  B
## 1   2 2  8 92
## 2   4 2 96  4
## 3   6 2 22 78
## 4   8 2 35 65
## 5  10 2 41 59
## 6  12 2 80 20
## 7  14 2  3 97
## 8   2 4 86 14
## 9   4 4 57 43
## 10  6 4 10 90
## 11  8 4 55 45
## 12 10 4 98  2
## 13 12 4 25 75
## 14 14 4 94  6
## 15  2 6 83 17
## 16  4 6 50 50
## 17  6 6 70 30
## 18  8 6 20 80
## 19 10 6 99  1
## 20 12 6 63 37
## 21 14 6 71 29
## 22  2 8 61 39
## 23  4 8 51 49
## 24  6 8 84 16
## 25  8 8 27 73
## 26 10 8 72 28
## 27 12 8 48 52
## 28 14 8 60 40</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="r语言ggplot2饼状图.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;scatterpie&quot;)</span></span>
<span id="cb196-2"><a href="r语言ggplot2饼状图.html#cb196-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3"><a href="r语言ggplot2饼状图.html#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scatterpie)</span>
<span id="cb196-4"><a href="r语言ggplot2饼状图.html#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb196-5"><a href="r语言ggplot2饼状图.html#cb196-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb196-6"><a href="r语言ggplot2饼状图.html#cb196-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_scatterpie</span>(<span class="at">data=</span>df,</span>
<span id="cb196-7"><a href="r语言ggplot2饼状图.html#cb196-7" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(x,y,<span class="at">r=</span><span class="fl">0.9</span>),</span>
<span id="cb196-8"><a href="r语言ggplot2饼状图.html#cb196-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>))<span class="sc">+</span></span>
<span id="cb196-9"><a href="r语言ggplot2饼状图.html#cb196-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()<span class="sc">+</span></span>
<span id="cb196-10"><a href="r语言ggplot2饼状图.html#cb196-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb196-11"><a href="r语言ggplot2饼状图.html#cb196-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb196-12"><a href="r语言ggplot2饼状图.html#cb196-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#5b9bd5&quot;</span>,<span class="st">&quot;#e64b35&quot;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-143-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r语言ggplot2折线图.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/NotebookOFXiaoMing/PracticalHandbookforggplot2/edit/master/07-pieplot.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/NotebookOFXiaoMing/PracticalHandbookforggplot2/blob/master/07-pieplot.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
